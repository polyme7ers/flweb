import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import r2_score , mean_squared_error
data=pd.read_csv("uber.csv")
data.head()
data.info()

data=data.dropna()
data=data[(data['fare_amount']>0)&(data['passenger_count']>0)]
data['distance']=np.sqrt((data['dropoff_latitude']-data['pickup_latitude'])**2 + (data['dropoff_longitude']-data['pickup_longitude'])**2)
data=data[data['fare_amount']<100]
X=data[['passenger_count','distance','pickup_longitude','pickup_latitude','dropoff_longitude','dropoff_latitude']]
y=data['fare_amount']

sns.boxplot(y=data['fare_amount'])
plt.title('Boxplot of Fare Amount (Outliers Detection)')
plt.show()

corr=data.select_dtypes(include=[np.number]).corr()
sns.heatmap(corr, annot=True,cmap='coolwarm')
plt.title('Correlation Heatmap')
plt.show()
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)

lr=LinearRegression()
lr.fit(X_train,y_train)
y_pred_lr=lr.predict(X_test)

rf=RandomForestRegressor(n_estimators=100 , random_state=42)
rf.fit(X_train,y_train)
y_pred_rf=rf.predict(X_test)

def evaluate_model(y_test, y_pred, model_name):
    r2 = r2_score(y_test, y_pred)
    rmse = np.sqrt(mean_squared_error(y_test, y_pred))
    print(f"{model_name} - RÂ²: {r2:.4f}, RMSE: {rmse:.4f}")
evaluate_model(y_test, y_pred_lr, "Linear Regression")
evaluate_model(y_test, y_pred_rf, "Random Forest Regressor")